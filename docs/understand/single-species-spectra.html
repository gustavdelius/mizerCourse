<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Single species spectra – mizer course</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../understand/predation-growth-and-mortality.html" rel="next">
<link href="../understand/observed-size-spectra.html" rel="prev">
<link href="../images/favicon-16x16.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-e8cfc4167d25a7c15f858dbe122f1a04.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="../site_libs/plotly-binding-4.10.4/plotly.js"></script><script src="../site_libs/typedarray-0.1/typedarray.min.js"></script><script src="../site_libs/jquery-3.5.1/jquery.min.js"></script><link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script><link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script><script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Single species spectra – mizer course">
<meta property="og:description" content="">
<meta property="og:image" content="https://mizer.course.sizespectrum.org/understand/single-species-spectra_files/figure-html/unnamed-chunk-3-1.png">
<meta property="og:site_name" content="mizer course">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
<meta name="twitter:title" content="Single species spectra – mizer course">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://mizer.course.sizespectrum.org/understand/single-species-spectra_files/figure-html/unnamed-chunk-3-1.png">
<meta name="twitter:creator" content="gustavdelius">
<meta name="twitter:site" content="@mizer_model">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../understand/index.html">Part 1: Understand</a></li><li class="breadcrumb-item"><a href="../understand/single-species-spectra.html">Single species spectra</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">mizer course</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://sizespectrum.org/mizer" class="sidebar-item-text sidebar-link"><i class="bi bi-house-door-fill" role="img">
</i> 
 <span class="menu-text">Back to mizer home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../prepare/install-tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Install tools</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 1: Understand</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../understand/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../understand/observed-size-spectra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Observed size spectra</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../understand/single-species-spectra.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Single species spectra</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../understand/predation-growth-and-mortality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Predation, growth and mortality</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../understand/species-interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Species interactions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../understand/dynamics-of-spectra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dynamics of size spectra</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 2: Build</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../build/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../build/collect-parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Collect parameters</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../build/create-first-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Create your first model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../build/refine.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Refine your model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../build/landings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Match landings data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../build/tune-resilience.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tune resilience</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 3: Use</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../use/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../use/fishing-scenarios.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explore fishing scenarios</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../use/change-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Change resource</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../use/further-scenarios.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explore further scenarios</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#single-species-model" id="toc-single-species-model" class="nav-link" data-scroll-target="#single-species-model">Single-species model</a></li>
  <li><a href="#steady-state-spectrum" id="toc-steady-state-spectrum" class="nav-link" data-scroll-target="#steady-state-spectrum">Steady state spectrum</a></li>
  <li><a href="#numbers" id="toc-numbers" class="nav-link" data-scroll-target="#numbers">Numbers</a></li>
  <li><a href="#other-representations" id="toc-other-representations" class="nav-link" data-scroll-target="#other-representations">Other representations</a></li>
  <li><a href="#biomass" id="toc-biomass" class="nav-link" data-scroll-target="#biomass">Biomass</a></li>
  <li><a href="#allometric-rates" id="toc-allometric-rates" class="nav-link" data-scroll-target="#allometric-rates">Allometric rates</a></li>
  <li><a href="#slope-of-juvenile-spectrum" id="toc-slope-of-juvenile-spectrum" class="nav-link" data-scroll-target="#slope-of-juvenile-spectrum">Slope of juvenile spectrum</a></li>
  <li>
<a href="#shape-of-adult-spectrum" id="toc-shape-of-adult-spectrum" class="nav-link" data-scroll-target="#shape-of-adult-spectrum">Shape of adult spectrum</a>
  <ul class="collapse">
<li><a href="#investment-into-reproduction" id="toc-investment-into-reproduction" class="nav-link" data-scroll-target="#investment-into-reproduction">Investment into reproduction</a></li>
  <li><a href="#change-in-maturity-curve" id="toc-change-in-maturity-curve" class="nav-link" data-scroll-target="#change-in-maturity-curve">Change in maturity curve</a></li>
  <li><a href="#two-curves-in-one-plot" id="toc-two-curves-in-one-plot" class="nav-link" data-scroll-target="#two-curves-in-one-plot">Two curves in one plot</a></li>
  <li><a href="#effect-of-changed-maturity" id="toc-effect-of-changed-maturity" class="nav-link" data-scroll-target="#effect-of-changed-maturity">Effect of changed maturity</a></li>
  </ul>
</li>
  <li><a href="#summary-and-recap" id="toc-summary-and-recap" class="nav-link" data-scroll-target="#summary-and-recap">Summary and recap</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/gustavdelius/mizerCourse/edit/master/understand/single-species-spectra.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gustavdelius/mizerCourse/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../understand/index.html">Part 1: Understand</a></li><li class="breadcrumb-item"><a href="../understand/single-species-spectra.html">Single species spectra</a></li></ol></nav><div class="quarto-title">
<h1 class="title">Single species spectra</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>At the end of the previous tutorial we plotted single-species size spectra from our dataset and observed that they were a bit of a mess. In this tutorial we will use the mizer model to gain an understanding of what determines the shape of a species size spectrum.</p>
<p>In this tutorial you are also going to start using mizer functions. When you want to learn more about any of the functions that we use in the examples, simply click on the function name. This will open the function’s help page in a new browser window.</p>
<p>First, load some required packages with the following commands:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sizespectrum.org/mizer/">mizer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://sizespectrum.org/mizerExperimental">mizerExperimental</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="single-species-model" class="level2"><h2 class="anchored" data-anchor-id="single-species-model">Single-species model</h2>
<p>In this and the next tutorial we want to keep the size-spectrum aspects of the mizer model separate from the multi-species aspects, so that we do not have to think about too many things at once. So we will explore a model where a single species lives in a non-dynamical background community that we will set to a Sheldon power-law abundance. Only in the fourth tutorial, exploring <a href="../understand/species-interactions.html">species interactions</a>, will we start to consider the interesting multi-species phenomena that arise in mizer models.</p>
<p>In this tutorial we will only be interested in the shape of the size spectrum, i.e., in how the total number of individuals is distributed over the different sizes. We are not yet interested in the overall abundance of the species. The overall abundance would be influenced by the total rate of reproduction and recruitment for the species. This in turn would be influenced by the size spectrum, because that determines how many of the individuals are mature. This dynamic feedback will of course become important when we build real-world models in Part 2 and use them in Part 3. But for now we have enough on our plate without thinking also about this.</p>
<p>Mizer collects all the parameters describing a size-spectrum model into one object of class <code>MizerParams</code>. You do not need to set up this object by hand because there are several wrapper functions in mizer that create the object for you for various types of models, and also many functions for changing specific parameters in a model. We will use the <code><a href="https://sizespectrum.org/mizer/reference/newSingleSpeciesParams.html">newSingleSpeciesParams()</a></code> function to set up a model describing a single fish species living in an ecosystem whose community size spectrum is given by a power-law.</p>
<p>The <code><a href="https://sizespectrum.org/mizer/reference/newSingleSpeciesParams.html">newSingleSpeciesParams()</a></code> function has many arguments that allow you to specify parameters for the fish species as well as for the community, but all these arguments have default values, so we can simply call the function without specifying those arguments. We will only specify the power-law exponent <code>lambda</code> of the background community. Note that in mizer the size spectrum exponent refers to the number density and is therefore expected to be around 2.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/newSingleSpeciesParams.html">newSingleSpeciesParams</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">2.05</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function returns a <code>MizerParams</code> object and we have assigned that to the variable <code>params</code>. We will be explaining more about this model as we go along.</p>
</section><section id="steady-state-spectrum" class="level2"><h2 class="anchored" data-anchor-id="steady-state-spectrum">Steady state spectrum</h2>
<p>As a final simplification in this and the next two tutorials, we will only consider the steady state size spectra. The steady state is the state where in each size class the inflow of individuals through growth exactly balances the outflow of individuals through growth and death. This means that the size spectrum is in equilibrium. The initial size spectrum of the species in the <code>params</code> object that we created with <code><a href="https://sizespectrum.org/mizer/reference/newSingleSpeciesParams.html">newSingleSpeciesParams()</a></code> has already been set to the steady state size spectrum.</p>
<p>We can plot the size spectrum with the <code><a href="https://sizespectrum.org/mizer/reference/plotSpectra.html">plotSpectra()</a></code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://sizespectrum.org/mizer/reference/plotSpectra.html">plotSpectra</a></span><span class="op">(</span><span class="va">params</span>, power <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <code>power = 0</code> argument to the <code><a href="https://sizespectrum.org/mizer/reference/plotSpectra.html">plotSpectra()</a></code> function specifies that we want to plot the number density, rather than for example the biomass density. We’ll discuss this more below in the section on <a href="#other-representations">other representations</a>.</p>
<p>The green line represents the number density of the background community, labelled as “Resource” in the plot legend, in which our foreground species finds itself. The green line is a straight line with slope <code>lambda = -2.05</code>. Thus the number density of the background community is proportional to <span class="math inline">w^{-2.05}</span>. It is important to understand that a power-law curve looks like a straight line when plotted on logarithmic axes and the slope of the line is the exponent in the power law. If this does not sound familiar, please revisit the section in the previous tutorial where we <a href="observed-size-spectra.qmdfitting-a-power-law">fitted a power-law</a> to the community spectrum.</p>
<p>The other line represents the number density of our single species, which by default is just named unimaginatively “Target species”. We see that it is a straight line initially, but then has a bump before declining rapidly at large sizes. We will discuss in a short while what causes that shape.</p>
<p>Remember what these size spectra plots indicate. They show the number density of individuals as a function of size. The initial slope of the target species’ number density is negative, which vaguely means that there are fewer larger fish than smaller fish. That is of course understandable: lots of fish die while they are growing up, so there tend to be fewer fish in larger size classes.</p>
<p>It is now time to do the first exercise of this tutorial.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Create a MizerParams object describing a single species in a power-law background where the Sheldon exponent is 2.1. Then plot the number density as a function of weight.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me the solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">params21</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/newSingleSpeciesParams.html">newSingleSpeciesParams</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">2.1</span><span class="op">)</span></span>
<span><span class="va">plot21</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/plotSpectra.html">plotSpectra</a></span><span class="op">(</span><span class="va">params21</span>, power <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">plot21</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="numbers" class="level2"><h2 class="anchored" data-anchor-id="numbers">Numbers</h2>
<p>While the <code><a href="https://sizespectrum.org/mizer/reference/plotSpectra.html">plotSpectra()</a></code> function gives us a plot of the number density, it would be nice if we could get at the actual numerical values. We can access them with the <code><a href="https://sizespectrum.org/mizer/reference/initialN-set.html">initialN()</a></code> function. Let us assign this to a variable <code>n</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/initialN-set.html">initialN</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As you can see in the “Environment” pane in RStudio, <code>n</code> is a matrix with 1 row and 101 columns.</p>
<p><img src="../images/n_env.png" class="img-fluid"></p>
<p>The one row corresponds to the one species. In a multispecies model there would be one row for each species, holding the number density for that species. The 101 columns are for the number densities in each of the 101 size classes. By default mizer uses 100+1 size clases (or size bins), although you can easily change that. In fact, <code>n</code> is a named array, i.e., each row and each column has names. These we can extract with the <code><a href="https://rdrr.io/r/base/dimnames.html">dimnames()</a></code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$sp
[1] "Target species"

$w
  [1] "0.001"   "0.00112" "0.00126" "0.00141" "0.00158" "0.00178" "0.002"  
  [8] "0.00224" "0.00251" "0.00282" "0.00316" "0.00355" "0.00398" "0.00447"
 [15] "0.00501" "0.00562" "0.00631" "0.00708" "0.00794" "0.00891" "0.01"   
 [22] "0.0112"  "0.0126"  "0.0141"  "0.0158"  "0.0178"  "0.02"    "0.0224" 
 [29] "0.0251"  "0.0282"  "0.0316"  "0.0355"  "0.0398"  "0.0447"  "0.0501" 
 [36] "0.0562"  "0.0631"  "0.0708"  "0.0794"  "0.0891"  "0.1"     "0.112"  
 [43] "0.126"   "0.141"   "0.158"   "0.178"   "0.2"     "0.224"   "0.251"  
 [50] "0.282"   "0.316"   "0.355"   "0.398"   "0.447"   "0.501"   "0.562"  
 [57] "0.631"   "0.708"   "0.794"   "0.891"   "1"       "1.12"    "1.26"   
 [64] "1.41"    "1.58"    "1.78"    "2"       "2.24"    "2.51"    "2.82"   
 [71] "3.16"    "3.55"    "3.98"    "4.47"    "5.01"    "5.62"    "6.31"   
 [78] "7.08"    "7.94"    "8.91"    "10"      "11.2"    "12.6"    "14.1"   
 [85] "15.8"    "17.8"    "20"      "22.4"    "25.1"    "28.2"    "31.6"   
 [92] "35.5"    "39.8"    "44.7"    "50.1"    "56.2"    "63.1"    "70.8"   
 [99] "79.4"    "89.1"    "100"    </code></pre>
</div>
</div>
<p>The names of the columns are the weight in grams at the start of each size class. Notice how R displays long vectors by breaking them across many lines and starting each line with a number in brackets. That number is the index of the first value in that row. So for example we see that the 61st size class starts at 1 gram. The number density in the size class between 1 gram and 1.12 grams (the start of the next size class) is</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">61</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0003282314</code></pre>
</div>
</div>
<p>It is important to realise that this is not the number of fish in the size class, but the average number density in the size class. To get the number of fish we have to multiply the number density by the width of the size class. Those widths can be obtained with the <code><a href="https://sizespectrum.org/mizer/reference/w.html">dw()</a></code> function. So the number of fish in each size class is obtained with</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">numbers</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">*</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/w.html">dw</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The number of individuals in the size class between 1 gram and 1.12 grams is</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">numbers</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">61</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.005029e-05</code></pre>
</div>
</div>
<p>You may be surprised by the small number if you interpret it as the number of fish between 1 gram and 1.12 gram in the entire ocean. However it looks more reasonable if it is the average number per square meter of sea. For more of a discussion of this issue of working with numbers per area, numbers per volume or numbers for the entire system see <a href="https://sizespectrum.org/mizer/reference/setParams.html#units-in-mizer" class="uri">https://sizespectrum.org/mizer/reference/setParams.html#units-in-mizer</a></p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Determine the total number of fish in the model with sizes between 10 grams and 20 grams. You can use the <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> function to add together contributions from the various size classes.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Give me a hint
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You have seen above how you can get the numbers in a single size bin. To get the numbers in each of a range of size bins you can use syntax like</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">numbers</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">61</span><span class="op">:</span><span class="fl">65</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           1         1.12         1.26         1.41         1.58 
4.005029e-05 3.702779e-05 3.423339e-05 3.164987e-05 2.926133e-05 </code></pre>
</div>
</div>
<p>You can pass a vector of numbers like this to the <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> function to add the numbers together.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me the solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The size bins covering the range from 10 to 20 grams are the bins 81 to 86 inclusive.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">numbers</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">81</span><span class="op">:</span><span class="fl">86</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.163148e-05</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="other-representations" class="level2"><h2 class="anchored" data-anchor-id="other-representations">Other representations</h2>
<p>We have seen in the previous tutorial on <a href="../understand/observed-size-spectra.html">observed size spectra</a> that the size spectrum can be represented in various ways. Besides the number density <span class="math inline">N(w)</span> we introduced the biomass density <span class="math inline">B(w)</span>, the number density in log weight <span class="math inline">N_{\log}(w)</span> and the biomass density in log weight <span class="math inline">B_{\log}(w)</span>. These were related to each other by multiplication by different powers of <span class="math inline">w</span>:</p>
<p><span class="math display">B(w) = N_{\log}(w) = w N(w) \text{ and } B_{\log}(w) = w^2 N(w).</span></p>
<p>We can use the <code>power</code> argument of the <code><a href="https://sizespectrum.org/mizer/reference/plotSpectra.html">plotSpectra()</a></code> function to determine which of these densities to plot. Above we plotted the number density by setting <code>power = 0</code>. Without the <code>power</code> argument (or with <code>power = 1</code> which is the default) the <code><a href="https://sizespectrum.org/mizer/reference/plotSpectra.html">plotSpectra()</a></code> function plots the biomass density as a function of weight, which is also the number density as a function of log weight:</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://sizespectrum.org/mizer/reference/plotSpectra.html">plotSpectra</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now the green line representing the biomass density of the background has a slope of -1.05. The initial slope of the species biomass density is also negative, meaning that the biomass density in the species decreases with size.</p>
<p>We can also plot the biomass density in log weight, i.e., the Sheldon spectrum, by supplying the argument <code>power = 2</code> to <code><a href="https://sizespectrum.org/mizer/reference/plotSpectra.html">plotSpectra()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://sizespectrum.org/mizer/reference/plotSpectra.html">plotSpectra</a></span><span class="op">(</span><span class="va">params</span>, power <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This now shows an approximately constant background biomass density in log weight (the slope of the green line is -0.05). The biomass density of the species in log size initially increases. So if binned in logarithmically-sized bins the biomass in each bin will initially increase, until it starts decreasing close to the maximum size of the species.</p>
<p>This latest plot seems to indicate that most of the biomass of the species is concentrated at larger sizes of around 30 grams, whereas the previous plot seemed to indicate that most of the biomass is at the smallest sizes. So which one is true? Please think about this question, because it really highlights the importance of not confusing biomass density with biomass. Questions about the amount of biomass <strong>at a size</strong> do not make sense. Instead you have to ask about biomass <strong>in a size range</strong>.</p>
<p>So for example, we might want to consider the prey biomass available to two different predators of our species, one small and one large. Assume that the smaller predator feeds on prey in the size range from 1g to 2g. The other predator, which we assume is 10 times larger, feeds on prey in the size range from 10g to 20g. These feeding intervals have the same width on the logarithmic weight axis. Therefore we should look at the plot of the biomass density in log weight to see that the larger predator has a lot more prey biomass from our species available to it than the smaller one. This is in spite of the fact that the plot of biomass density in weight tells us that the biomass density is lower at 10g than at 1g.</p>
<p>It may have been a bit confusing that we displayed the same size spectrum in three different ways. But it is important to be aware of this because in the literature you will see all different conventions being used, so if you see a plot of a size spectrum you always need to ask yourself exactly which density is being shown.</p>
</section><section id="biomass" class="level2"><h2 class="anchored" data-anchor-id="biomass">Biomass</h2>
<p>As we did for <a href="#numbers">numbers</a> above, let us also look at how to extract biomasses from the model.</p>
<p>We already said above that we can obtain the biomass density in a size class from the number density by multiplying the number density by the weight of the individuals in the size class. To obtain the appropriate weights, we use the function <code><a href="https://sizespectrum.org/mizer/reference/w.html">w()</a></code> that returns the weights at the start of each size class. So we calculate</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">biomass_density</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">*</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/w.html">w</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We obtain the total biomass in each size class by multiplying the biomass density in each size class by the width of each size class</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">biomass</span> <span class="op">&lt;-</span> <span class="va">biomass_density</span> <span class="op">*</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/w.html">dw</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For example the biomass of fish between 1 gram and 1.12 grams is</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">biomass</span><span class="op">[</span><span class="fl">61</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.005029e-05</code></pre>
</div>
</div>
<p>Let us briefly present yet another way to represent the size distribution. When we talk about size spectra, we always have the representation in terms of densities in mind. You may already be familiar with the concept of a densities from probability theory, where you can describe a probability distribution in terms of its probability density function. But perhaps you also know that there is an alternative description of the probability distribution in terms of the cumulative distribution function. We can similarly describe the size distribution of the biomass by a cumulative biomass distribution function, which gives the total biomass of all sizes up to a specific size.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Initialise an array with the right dimensions</span></span>
<span><span class="va">cumulative_biomass</span> <span class="op">&lt;-</span> <span class="va">biomass</span></span>
<span><span class="co"># Calculate the cumulative sum of all biomasses in previous bins</span></span>
<span><span class="va">cumulative_biomass</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">biomass</span><span class="op">)</span></span>
<span><span class="co"># Normalise this so that it is given as a percentage of the total biomass</span></span>
<span><span class="va">cdf</span> <span class="op">&lt;-</span> <span class="va">cumulative_biomass</span> <span class="op">/</span> <span class="va">cumulative_biomass</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">101</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="co"># Melt the array to a data frame and then plot</span></span>
<span><span class="va">p_biomass_cdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">cdf</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">w</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Weight [g]"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"% of total biomass"</span><span class="op">)</span></span>
<span><span class="va">p_biomass_cdf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Expand for R details
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Mizer likes to work with arrays instead of data frames. Our variables <code>n</code>, <code>biomass</code>, <code>cumulative_biomass</code> and <code>cdf</code> are all arrays. I hope you noticed the magic how R can do calculations with all entries of an array in one go.</p>
<p>ggplot2 on the other hand likes to work with data frames instead of arrays. The function <code><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt()</a></code> allows us to convert the mizer arrays into data frames suitable for <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. You will see this discussed again later.</p>
</div>
</div>
</div>
<p>This plot shows us for example that 50% of the individuals are smaller than 12.5g and only a very small percentage is larger than 75g.</p>
<p>The biomass density is the slope of this graph. We can also plot the cumulative biomass distribution function on a logarithmic weight axis:</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p_biomass_cdf</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This graph contains exactly the same information as the previous graph, just showing more detail at smaller sizes and less detail at larger sizes. We can see for example that about 20% of the total biomass is from individuals smaller than 1g, which was difficult to see in the previous graph. The slope of this graph is the biomass density in log weight.</p>
</section><section id="allometric-rates" class="level2"><h2 class="anchored" data-anchor-id="allometric-rates">Allometric rates</h2>
<p>The first striking feature of the species size-spectrum, independently of which density you plot, is that for small fish (larvae and juveniles) it is given by a straight line. This is due to the allometric scaling of the physiological rates that our model is assuming and which we will discuss in this section. The other striking feature is the bulge at around maturity size, which we will discuss in the section on the <a href="#shape-of-adult-spectrum">shape of the adult spectrum</a>.</p>
<p>We will assume that the metabolic rate, i.e., the rate at which an organism expends energy on its basic metabolic needs, scales as a power of the organism’s body size, and the power is about <span class="math inline">p = 3/4</span>.</p>
<p>Because this energy needs to be supplied by consumption of food, it is natural to assume that also the consumption rate scales allometrically with a power of <span class="math inline">n = 3/4</span>. When the consumption is greater than the metabolic cost then the excess leads to growth. Hence the growth rate too scales allometrically with power <span class="math inline">3/4</span>.</p>
<p>In a multi-species mizer model the mortality is an emergent property that depends on the abundance of predators. In this single species model the mortality rate is set to the one that would emerge if all the species in the fixed background community predated with the same ferocity as the target species. This leads to a mortality rate that scale allometrically with a power of <span class="math inline">n - 1 = 3/4 - 1 = -1/4</span>. This means that the death rate experienced by larger individuals is smaller than that of smaller individuals.</p>
<p>It is a result of the mathematics that if the growth and death rates scale allometrically with exponents <span class="math inline">p</span> and <span class="math inline">n=1-p</span> respectively, for some metabolic exponent <span class="math inline">p</span>, that the number density at steady state is also a power law, i.e., a straight line on the log-log plot.</p>
<p>Let us check that in our model the physiological rates are indeed power laws, at least for the small sizes. We can get the growth rate with the <code><a href="https://sizespectrum.org/mizer/reference/getEGrowth.html">getEGrowth()</a></code> function. We assign the result to a variable that we name <code>growth_rate</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">growth_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/getEGrowth.html">getEGrowth</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can again see in the “Environment” pane that this is a matrix with one row for the one species and 101 columns for the 101 size classes. So for example the growth rate at size 1 gram is</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">growth_rate</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">61</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.2</code></pre>
</div>
</div>
<p>(because we had seen that the 61st size class starts at 1 gram). This is the instantaneous per-capita growth rate, measured in grams per year. Note that in mizer all rates are measured in units of 1/year, but for many people daily values are easier to understand. Since growth rate here is an instantaneous rate we can simply divide it by 365 to get a daily rate (although note that mizer does not simulate processes on daily time steps). This gives us a growth rate in grams per day for a 1g sized fish of</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">growth_rate</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">61</span><span class="op">]</span> <span class="op">/</span> <span class="fl">365</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01150685</code></pre>
</div>
</div>
<p>We would like to make a log-log plot of the growth rate against size to check that it gives a straight line. We will use <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> for that purpose. <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> likes to work with data frames instead of named matrices, so we first convert the matrix into a data frame with the <code><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt()</a></code> function.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">growth_rate_frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">growth_rate</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can see in the “Environment” pane that the new variable that we called <code>growth_rate_frame</code> is a data frame with 101 observations of 3 variables. The 101 observations correspond to the 101 size classes. The 3 variables have names</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">growth_rate_frame</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sp"    "w"     "value"</code></pre>
</div>
</div>
<p>They are the species <code>sp</code>, the size <code>w</code>, and the <code>value</code> which contains the growth_rate. This data frame we can pass to <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">growth_rate_frame</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">w</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Weight [g]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Growth rate [g/year]"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note how we linked the x axis to the <code>w</code> variable and the y axis to the <code>value</code> variable and specified that both axes should be on a logarithmic scale.</p>
<p>We see that at least up to a size of a few grams the line is straight. Let’s isolate the growth rate for those smaller sizes</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">g_small_fish</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">growth_rate_frame</span>, <span class="va">w</span> <span class="op">&lt;=</span> <span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and fit a linear model</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">g_small_fish</span><span class="op">$</span><span class="va">value</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">g_small_fish</span><span class="op">$</span><span class="va">w</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(g_small_fish$value) ~ log(g_small_fish$w))

Coefficients:
        (Intercept)  log(g_small_fish$w)  
              1.435                0.750  </code></pre>
</div>
</div>
<p>The slope of the line is indeed <span class="math inline">0.75 = 3/4</span>. In fact, the above shows that for juveniles <span class="math display">\log(g(w)) \approx 1.435 + \frac34 \log(w)</span> and thus <span class="math display">g(w) = g_0\ w^p \approx \exp(1.435)\  w^{3/4}\approx 4.2\  w^{3/4}.</span></p>
<p>Of course in a real model, the growth rate would not so exactly follow a power law, because the growth rate would vary depending on food availability, for example. In this example food is the background resource and its abundance is fixed, so food abundance does not vary.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Use the methods you have just seen to make a log-log plot of the mortality rate. You can get the mortality rate with the <code><a href="https://sizespectrum.org/mizer/reference/getMort.html">getMort()</a></code> function. While adjusting the code to this new task, you need to take into account that the name of the size-dimension of the array returned by <code><a href="https://sizespectrum.org/mizer/reference/getMort.html">getMort()</a></code> is <code>"w_prey"</code> instead of <code>"w"</code>.</p>
<p>Then fit a linear model to determine the slope and and intercept and thus the allometric exponent <span class="math inline">r</span> and the coefficient <span class="math inline">\mu_0</span> for the mortality rate <span class="math display">\mu(w) = \mu_0 w^r.</span></p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me the solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mort_rate_frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://sizespectrum.org/mizer/reference/getMort.html">getMort</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mort_rate_frame</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">w_prey</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Weight [g]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Mortality rate [1/year]"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">mort_rate_frame</span><span class="op">$</span><span class="va">value</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">mort_rate_frame</span><span class="op">$</span><span class="va">w_prey</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(mort_rate_frame$value) ~ log(mort_rate_frame$w_prey))

Coefficients:
                (Intercept)  log(mort_rate_frame$w_prey)  
                       1.36                        -0.25  </code></pre>
</div>
</div>
<p>To get the coefficient <span class="math inline">\mu_0</span> for the mortality rate we need to exponentiate the intercept</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mm</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">m0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.896722</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="slope-of-juvenile-spectrum" class="level2"><h2 class="anchored" data-anchor-id="slope-of-juvenile-spectrum">Slope of juvenile spectrum</h2>
<p>We have seen that for juvenile fish the growth rate and the death rate are both power laws with exponents <span class="math inline">p=3/4</span> and <span class="math inline">r=p-1=-1/4</span> respectively. By solving a differential equation we can derive that the juvenile spectrum also follows a power law: <span class="math display">N(w) = N_0\ w^{-\mu_0/g_0 - p}.</span></p>
<p>I won’t do the maths here with you (and you probably don’t want me to anyway), but we can see that the result makes sense. It tells us that the number density drops off faster with size if the mortality rate coefficient <span class="math inline">\mu_0</span> is higher or if the growth rate coefficient <span class="math inline">g_0</span> is smaller, which is what we would expect.</p>
<p>We can also check this claim numerically. Let’s look at the spectrum of individuals up to 10 grams. By now we know how to do this. We first convert the number density matrix <code>n</code> into a dataframe and then filter out all observations that do not have <span class="math inline">w\leq 10</span>. The resulting data frame we pass to <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> and ask it to plot a line on log-log axes.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">w</span> <span class="op">&lt;=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nf</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">w</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Weight [g]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Number density [1/g]"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That confirms what we had seen earlier, that for fish less than 10 grams the number density is a power law. To determine the exponent of the power law we need the slope of that straight line in the log-log plot, and the easiest way to do that is to fit a linear model to the log variables:</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">nf</span><span class="op">$</span><span class="va">value</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">nf</span><span class="op">$</span><span class="va">w</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(nf$value) ~ log(nf$w))

Coefficients:
(Intercept)    log(nf$w)  
     -8.022       -1.682  </code></pre>
</div>
</div>
<p>The linear model fit says that the exponent is -1.682. The mathematics claimed that the exponent should be <span class="math inline">-\mu_0 / g_0 - p</span>. We have already observed that <span class="math inline">g_0 \approx 4.2</span> and you have determined <span class="math inline">\mu_0</span> in Exercise 3, so we get</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">-</span><span class="va">m0</span> <span class="op">/</span> <span class="va">g0</span> <span class="op">-</span> <span class="fl">3</span><span class="op">/</span><span class="fl">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.6777</code></pre>
</div>
</div>
<p>That is not quite the result of the linear model fit, but that is the nature of numerical calculations: one gets discretisation errors and rounding errors. Anyway, it is close enough. And it is also amazing how we can calculate expected numbers of fish from basic assumptions and rules. Of course, natural ecosystems never look like that, but if we have theoretical expectations derived from clear assumptions (about growth and mortality rate and food availability), we can start asking questions about which processes in natural ecosystems deviate from these generic assumptions, why this happens and how it should affect the observed size spectra.</p>
</section><section id="shape-of-adult-spectrum" class="level2"><h2 class="anchored" data-anchor-id="shape-of-adult-spectrum">Shape of adult spectrum</h2>
<p>Now that we understand the shape of the size spectrum for the juvenile fish, let us try to understand the shape of the adult spectrum. Here is the plot of the biomass density again, but with the <span class="math inline">w</span> axis restricted to weights above 10g:</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://sizespectrum.org/mizer/reference/plotSpectra.html">plotSpectra</a></span><span class="op">(</span><span class="va">params</span>, wlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The increase of abundance that we see at around the maturity size of our species is due to a drop in growth rate at that size. This in turn is due to the fact that the mature fish invests some of its energy into reproduction instead of growth. So the details of the shape of the adult spectrum will be influenced both by food intake, maintenance and mortality (like in juveniles), but also by how adults split their energy income between growth and reproduction.</p>
<section id="investment-into-reproduction" class="level3"><h3 class="anchored" data-anchor-id="investment-into-reproduction">Investment into reproduction</h3>
<p>Let us look at a plot of the proportion of the available energy that is invested into reproduction as a function of the size. This is the product of the proportion of individuals that are mature (obtained with the function <code><a href="https://sizespectrum.org/mizer/reference/setReproduction.html">maturity()</a></code> and the proportion of their energy income that a mature fish invests into reproduction (obtained with the function <code><a href="https://sizespectrum.org/mizer/reference/setReproduction.html">repro_prop()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reprod_proportion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/setReproduction.html">maturity</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/setReproduction.html">repro_prop</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span>
<span><span class="co"># Convert the array to a data frame for ggplot</span></span>
<span><span class="va">psi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">reprod_proportion</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">psi</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">w</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Weight [g]"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Proportion invested into reproduction"</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>How was this maturity curve specified? You can find the details in the <a href="https://sizespectrum.org/mizer/reference/setReproduction.html#investment">mizer documentation</a>. There are four species parameters involved:</p>
<ul>
<li>the maturity size <code>w_mat</code> at which 50% of the individuals are mature.</li>
<li>the size <code>w_mat25</code> at which 25% of the individuals are mature.</li>
<li>the asymptotic size <code>w_max</code> at which an organism invests 100% of its income into reproduction and thus growth is zero.</li>
<li>an exponent <code>m</code> that determines how the proportion that an individual invests into reproduction scales with its size.</li>
</ul>
<p>Such species parameters are contained in a data frame inside the <code>params</code> object that we can access with the <code><a href="https://sizespectrum.org/mizer/reference/species_params.html">species_params()</a></code> function.</p>
<div class="cell" data-df-print="tibble">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://sizespectrum.org/mizer/reference/species_params.html">species_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["species"],"name":[1],"type":["chr"],"align":["left"]},{"label":["w_min"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["w_max"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["w_mat"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["w_min_idx"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["h"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["gamma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["ks"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["f0"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["fc"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["beta"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["z0"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["alpha"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["erepro"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["n"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["p"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["w_repro_max"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["interaction_resource"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["pred_kernel_type"],"name":[20],"type":["chr"],"align":["left"]},{"label":["k"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["q"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["w_mat25"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["m"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["R_max"],"name":[25],"type":["dbl"],"align":["right"]}],"data":[{"1":"Target species","2":"0.001","3":"100","4":"25.11886","5":"1","6":"30","7":"2066.004","8":"3","9":"0.6","10":"0.25","11":"100","12":"1.3","13":"0","14":"0.4","15":"0.899483","16":"0.75","17":"0.75","18":"100","19":"1","20":"lognormal","21":"0","22":"0.8","23":"22.50546","24":"1","25":"Inf","_rn_":"Target species"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>As you can see, there are a lot of other species parameters, some of which we will talk about later. For now let’s just select the 4 parameters we are interested in.</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://sizespectrum.org/mizer/reference/species_params.html">species_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span>, <span class="va">w_mat</span>, <span class="va">w_mat25</span>, <span class="va">w_max</span>, <span class="va">m</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["w_mat"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["w_mat25"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["w_max"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["m"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"25.11886","2":"22.50546","3":"100","4":"1","_rn_":"Target species"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>And with this knowledge of parameter we can improve the plot for clarity and add a vertical line at 25% and 50% maturation weight</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/species_params.html">species_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">$</span><span class="va">w_mat</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/species_params.html">species_params</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span><span class="op">$</span><span class="va">w_mat25</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="change-in-maturity-curve" class="level3"><h3 class="anchored" data-anchor-id="change-in-maturity-curve">Change in maturity curve</h3>
<p>Let us investigate what happens when we change the maturity curve. Let’s assume the maturity size is actually 40 grams and the size at which 25% of individuals is mature is 30 grams. Let us change the values in the <code>species_params</code> data frame. But first we make a copy of the params object so that we can keep the old version around unchanged.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">params_changed_maturity</span> <span class="op">&lt;-</span> <span class="va">params</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this copy we now change the species parameters</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://sizespectrum.org/mizer/reference/species_params.html">given_species_params</a></span><span class="op">(</span><span class="va">params_changed_maturity</span><span class="op">)</span><span class="op">$</span><span class="va">w_mat</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="fu"><a href="https://sizespectrum.org/mizer/reference/species_params.html">given_species_params</a></span><span class="op">(</span><span class="va">params_changed_maturity</span><span class="op">)</span><span class="op">$</span><span class="va">w_mat25</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://sizespectrum.org/mizer/reference/species_params.html">species_params</a></span><span class="op">(</span><span class="va">params_changed_maturity</span><span class="op">)</span>, <span class="va">w_mat</span>, <span class="va">w_mat25</span>, <span class="va">w_max</span>, <span class="va">m</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["w_mat"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["w_mat25"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["w_max"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["m"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"40","2":"30","3":"100","4":"1","_rn_":"Target species"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now the maturity curve has changed, which we can verify by plotting it</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">psi_changed_maturity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://sizespectrum.org/mizer/reference/setReproduction.html">maturity</a></span><span class="op">(</span><span class="va">params_changed_maturity</span><span class="op">)</span> <span class="op">*</span> </span>
<span>                                 <span class="fu"><a href="https://sizespectrum.org/mizer/reference/setReproduction.html">repro_prop</a></span><span class="op">(</span><span class="va">params_changed_maturity</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">psi_changed_maturity</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">w</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/species_params.html">species_params</a></span><span class="op">(</span><span class="va">params_changed_maturity</span><span class="op">)</span><span class="op">$</span><span class="va">w_mat</span>, </span>
<span>               lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/species_params.html">species_params</a></span><span class="op">(</span><span class="va">params_changed_maturity</span><span class="op">)</span><span class="op">$</span><span class="va">w_mat25</span>, </span>
<span>               lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Weight [g]"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Proportion invested into reproduction"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="two-curves-in-one-plot" class="level3"><h3 class="anchored" data-anchor-id="two-curves-in-one-plot">Two curves in one plot</h3>
<p>At this point let’s take a little break and learn how to draw two curves in the same graph. How can we see the old maturity curve and the new maturity curve in the same plot? First we add an extra column to each dataframe describing it</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">psi</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"original"</span></span>
<span><span class="va">psi_changed_maturity</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"changed"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we bind the two data frames together</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">psi_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">psi</span>, <span class="va">psi_changed_maturity</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and send that combined data frame first to <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. We also run the plot through <code><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">plotly::ggplotly()</a></code> to make it interactive, but that is of course entirely optional.</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">psi_combined</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">w</span>, y <span class="op">=</span> <span class="va">value</span>, colour <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Weight [g]"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Proportion invested into reproduction"</span><span class="op">)</span></span>
<span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-43041af5c5f341e66e9b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-43041af5c5f341e66e9b">{"x":{"data":[{"x":[0.001,0.0011199999999999999,0.0012600000000000001,0.00141,0.00158,0.0017799999999999999,0.002,0.0022399999999999998,0.0025100000000000001,0.00282,0.00316,0.0035500000000000002,0.00398,0.00447,0.0050099999999999997,0.00562,0.0063099999999999996,0.0070800000000000004,0.0079399999999999991,0.0089099999999999995,0.01,0.0112,0.0126,0.0141,0.015800000000000002,0.0178,0.02,0.0224,0.025100000000000001,0.028199999999999999,0.031600000000000003,0.035499999999999997,0.039800000000000002,0.044699999999999997,0.050099999999999999,0.0562,0.063100000000000003,0.070800000000000002,0.079399999999999998,0.089099999999999999,0.10000000000000001,0.112,0.126,0.14099999999999999,0.158,0.17799999999999999,0.20000000000000001,0.224,0.251,0.28199999999999997,0.316,0.35499999999999998,0.39800000000000002,0.44700000000000001,0.501,0.56200000000000006,0.63100000000000001,0.70799999999999996,0.79400000000000004,0.89100000000000001,1,1.1200000000000001,1.26,1.4099999999999999,1.5800000000000001,1.78,2,2.2400000000000002,2.5099999999999998,2.8199999999999998,3.1600000000000001,3.5499999999999998,3.98,4.4699999999999998,5.0099999999999998,5.6200000000000001,6.3099999999999996,7.0800000000000001,7.9400000000000004,8.9100000000000001,10,11.199999999999999,12.6,14.1,15.800000000000001,17.800000000000001,20,22.399999999999999,25.100000000000001,28.199999999999999,31.600000000000001,35.5,39.799999999999997,44.700000000000003,50.100000000000001,56.200000000000003,63.100000000000001,70.799999999999997,79.400000000000006,89.099999999999994,100],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3.5563768154409092e-09,5.6813278391748569e-09,9.0759465455505277e-09,1.4498864959286132e-08,2.3162000988257612e-08,3.7001398548992331e-08,5.9109895555544493e-08,9.4428312164988344e-08,1.5084962510091301e-07,2.4098288613636486e-07,3.8497107751250854e-07,6.1499261819799972e-07,9.8245246494252919e-07,1.5694697415687902e-06,2.5072288149212386e-06,4.0052940721278241e-06,6.3984375602042623e-06,1.0221439287559012e-05,1.6328563529667724e-05,2.6084379346709067e-05,4.166848957864662e-05,6.6562069951306375e-05,0.00010632445610925538,0.00016983210595286844,0.00027125378750646916,0.00043319589806808029,0.00069170225722061036,0.0011041798549748843,0.0017619087585751603,0.0028096542858920357,0.0044760862945328632,0.0071201612189354764,0.011299905486397862,0.017869773961016872,0.028107480379991105,0.043853710741911786,0.067606992505938365,0.10244274576577747,0.15154396133740497,0.21715282593363988,0.29907997699905892,0.39356711379337589,0.49366394002363551,0.59142736473455781,0.68063142230955165,0.75823536724359175,0.82413227838623826,0.87998568871563054,0.92809054636806043,0.97066412229077947],"text":["w: 1.00e-03<br />value: 0.000000e+00<br />type: changed","w: 1.12e-03<br />value: 0.000000e+00<br />type: changed","w: 1.26e-03<br />value: 0.000000e+00<br />type: changed","w: 1.41e-03<br />value: 0.000000e+00<br />type: changed","w: 1.58e-03<br />value: 0.000000e+00<br />type: changed","w: 1.78e-03<br />value: 0.000000e+00<br />type: changed","w: 2.00e-03<br />value: 0.000000e+00<br />type: changed","w: 2.24e-03<br />value: 0.000000e+00<br />type: changed","w: 2.51e-03<br />value: 0.000000e+00<br />type: changed","w: 2.82e-03<br />value: 0.000000e+00<br />type: changed","w: 3.16e-03<br />value: 0.000000e+00<br />type: changed","w: 3.55e-03<br />value: 0.000000e+00<br />type: changed","w: 3.98e-03<br />value: 0.000000e+00<br />type: changed","w: 4.47e-03<br />value: 0.000000e+00<br />type: changed","w: 5.01e-03<br />value: 0.000000e+00<br />type: changed","w: 5.62e-03<br />value: 0.000000e+00<br />type: changed","w: 6.31e-03<br />value: 0.000000e+00<br />type: changed","w: 7.08e-03<br />value: 0.000000e+00<br />type: changed","w: 7.94e-03<br />value: 0.000000e+00<br />type: changed","w: 8.91e-03<br />value: 0.000000e+00<br />type: changed","w: 1.00e-02<br />value: 0.000000e+00<br />type: changed","w: 1.12e-02<br />value: 0.000000e+00<br />type: changed","w: 1.26e-02<br />value: 0.000000e+00<br />type: changed","w: 1.41e-02<br />value: 0.000000e+00<br />type: changed","w: 1.58e-02<br />value: 0.000000e+00<br />type: changed","w: 1.78e-02<br />value: 0.000000e+00<br />type: changed","w: 2.00e-02<br />value: 0.000000e+00<br />type: changed","w: 2.24e-02<br />value: 0.000000e+00<br />type: changed","w: 2.51e-02<br />value: 0.000000e+00<br />type: changed","w: 2.82e-02<br />value: 0.000000e+00<br />type: changed","w: 3.16e-02<br />value: 0.000000e+00<br />type: changed","w: 3.55e-02<br />value: 0.000000e+00<br />type: changed","w: 3.98e-02<br />value: 0.000000e+00<br />type: changed","w: 4.47e-02<br />value: 0.000000e+00<br />type: changed","w: 5.01e-02<br />value: 0.000000e+00<br />type: changed","w: 5.62e-02<br />value: 0.000000e+00<br />type: changed","w: 6.31e-02<br />value: 0.000000e+00<br />type: changed","w: 7.08e-02<br />value: 0.000000e+00<br />type: changed","w: 7.94e-02<br />value: 0.000000e+00<br />type: changed","w: 8.91e-02<br />value: 0.000000e+00<br />type: changed","w: 1.00e-01<br />value: 0.000000e+00<br />type: changed","w: 1.12e-01<br />value: 0.000000e+00<br />type: changed","w: 1.26e-01<br />value: 0.000000e+00<br />type: changed","w: 1.41e-01<br />value: 0.000000e+00<br />type: changed","w: 1.58e-01<br />value: 0.000000e+00<br />type: changed","w: 1.78e-01<br />value: 0.000000e+00<br />type: changed","w: 2.00e-01<br />value: 0.000000e+00<br />type: changed","w: 2.24e-01<br />value: 0.000000e+00<br />type: changed","w: 2.51e-01<br />value: 0.000000e+00<br />type: changed","w: 2.82e-01<br />value: 0.000000e+00<br />type: changed","w: 3.16e-01<br />value: 0.000000e+00<br />type: changed","w: 3.55e-01<br />value: 3.556377e-09<br />type: changed","w: 3.98e-01<br />value: 5.681328e-09<br />type: changed","w: 4.47e-01<br />value: 9.075947e-09<br />type: changed","w: 5.01e-01<br />value: 1.449886e-08<br />type: changed","w: 5.62e-01<br />value: 2.316200e-08<br />type: changed","w: 6.31e-01<br />value: 3.700140e-08<br />type: changed","w: 7.08e-01<br />value: 5.910990e-08<br />type: changed","w: 7.94e-01<br />value: 9.442831e-08<br />type: changed","w: 8.91e-01<br />value: 1.508496e-07<br />type: changed","w: 1.00e+00<br />value: 2.409829e-07<br />type: changed","w: 1.12e+00<br />value: 3.849711e-07<br />type: changed","w: 1.26e+00<br />value: 6.149926e-07<br />type: changed","w: 1.41e+00<br />value: 9.824525e-07<br />type: changed","w: 1.58e+00<br />value: 1.569470e-06<br />type: changed","w: 1.78e+00<br />value: 2.507229e-06<br />type: changed","w: 2.00e+00<br />value: 4.005294e-06<br />type: changed","w: 2.24e+00<br />value: 6.398438e-06<br />type: changed","w: 2.51e+00<br />value: 1.022144e-05<br />type: changed","w: 2.82e+00<br />value: 1.632856e-05<br />type: changed","w: 3.16e+00<br />value: 2.608438e-05<br />type: changed","w: 3.55e+00<br />value: 4.166849e-05<br />type: changed","w: 3.98e+00<br />value: 6.656207e-05<br />type: changed","w: 4.47e+00<br />value: 1.063245e-04<br />type: changed","w: 5.01e+00<br />value: 1.698321e-04<br />type: changed","w: 5.62e+00<br />value: 2.712538e-04<br />type: changed","w: 6.31e+00<br />value: 4.331959e-04<br />type: changed","w: 7.08e+00<br />value: 6.917023e-04<br />type: changed","w: 7.94e+00<br />value: 1.104180e-03<br />type: changed","w: 8.91e+00<br />value: 1.761909e-03<br />type: changed","w: 1.00e+01<br />value: 2.809654e-03<br />type: changed","w: 1.12e+01<br />value: 4.476086e-03<br />type: changed","w: 1.26e+01<br />value: 7.120161e-03<br />type: changed","w: 1.41e+01<br />value: 1.129991e-02<br />type: changed","w: 1.58e+01<br />value: 1.786977e-02<br />type: changed","w: 1.78e+01<br />value: 2.810748e-02<br />type: changed","w: 2.00e+01<br />value: 4.385371e-02<br />type: changed","w: 2.24e+01<br />value: 6.760699e-02<br />type: changed","w: 2.51e+01<br />value: 1.024427e-01<br />type: changed","w: 2.82e+01<br />value: 1.515440e-01<br />type: changed","w: 3.16e+01<br />value: 2.171528e-01<br />type: changed","w: 3.55e+01<br />value: 2.990800e-01<br />type: changed","w: 3.98e+01<br />value: 3.935671e-01<br />type: changed","w: 4.47e+01<br />value: 4.936639e-01<br />type: changed","w: 5.01e+01<br />value: 5.914274e-01<br />type: changed","w: 5.62e+01<br />value: 6.806314e-01<br />type: changed","w: 6.31e+01<br />value: 7.582354e-01<br />type: changed","w: 7.08e+01<br />value: 8.241323e-01<br />type: changed","w: 7.94e+01<br />value: 8.799857e-01<br />type: changed","w: 8.91e+01<br />value: 9.280905e-01<br />type: changed","w: 1.00e+02<br />value: 9.706641e-01<br />type: changed"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"changed","legendgroup":"changed","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.001,0.0011199999999999999,0.0012600000000000001,0.00141,0.00158,0.0017799999999999999,0.002,0.0022399999999999998,0.0025100000000000001,0.00282,0.00316,0.0035500000000000002,0.00398,0.00447,0.0050099999999999997,0.00562,0.0063099999999999996,0.0070800000000000004,0.0079399999999999991,0.0089099999999999995,0.01,0.0112,0.0126,0.0141,0.015800000000000002,0.0178,0.02,0.0224,0.025100000000000001,0.028199999999999999,0.031600000000000003,0.035499999999999997,0.039800000000000002,0.044699999999999997,0.050099999999999999,0.0562,0.063100000000000003,0.070800000000000002,0.079399999999999998,0.089099999999999999,0.10000000000000001,0.112,0.126,0.14099999999999999,0.158,0.17799999999999999,0.20000000000000001,0.224,0.251,0.28199999999999997,0.316,0.35499999999999998,0.39800000000000002,0.44700000000000001,0.501,0.56200000000000006,0.63100000000000001,0.70799999999999996,0.79400000000000004,0.89100000000000001,1,1.1200000000000001,1.26,1.4099999999999999,1.5800000000000001,1.78,2,2.2400000000000002,2.5099999999999998,2.8199999999999998,3.1600000000000001,3.5499999999999998,3.98,4.4699999999999998,5.0099999999999998,5.6200000000000001,6.3099999999999996,7.0800000000000001,7.9400000000000004,8.9100000000000001,10,11.199999999999999,12.6,14.1,15.800000000000001,17.800000000000001,20,22.399999999999999,25.100000000000001,28.199999999999999,31.600000000000001,35.5,39.799999999999997,44.700000000000003,50.100000000000001,56.200000000000003,63.100000000000001,70.799999999999997,79.400000000000006,89.099999999999994,100],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.4537843396349616e-08,4.7315121164635689e-08,1.5399260390921097e-07,5.0118673244053845e-07,1.631167751022491e-06,5.3087913543963467e-06,1.7277713435806435e-05,5.6228509668067838e-05,0.00018296275272854416,0.00059506707645256315,0.0019325414034447532,0.0062471024205959808,0.019905774407402616,0.06075853796078276,0.16526045796785868,0.35397289219207018,0.55356541878627097,0.68172200848405073,0.74813345836295542,0.78646359873691274,0.81494595256361357,0.84055458705813713,0.86569056796569566,0.89116182195155069,0.91724692949503983,0.94405143577156581,0.97162487902945727,0.99999900000100006],"text":["w: 1.00e-03<br />value: 0.000000e+00<br />type: original","w: 1.12e-03<br />value: 0.000000e+00<br />type: original","w: 1.26e-03<br />value: 0.000000e+00<br />type: original","w: 1.41e-03<br />value: 0.000000e+00<br />type: original","w: 1.58e-03<br />value: 0.000000e+00<br />type: original","w: 1.78e-03<br />value: 0.000000e+00<br />type: original","w: 2.00e-03<br />value: 0.000000e+00<br />type: original","w: 2.24e-03<br />value: 0.000000e+00<br />type: original","w: 2.51e-03<br />value: 0.000000e+00<br />type: original","w: 2.82e-03<br />value: 0.000000e+00<br />type: original","w: 3.16e-03<br />value: 0.000000e+00<br />type: original","w: 3.55e-03<br />value: 0.000000e+00<br />type: original","w: 3.98e-03<br />value: 0.000000e+00<br />type: original","w: 4.47e-03<br />value: 0.000000e+00<br />type: original","w: 5.01e-03<br />value: 0.000000e+00<br />type: original","w: 5.62e-03<br />value: 0.000000e+00<br />type: original","w: 6.31e-03<br />value: 0.000000e+00<br />type: original","w: 7.08e-03<br />value: 0.000000e+00<br />type: original","w: 7.94e-03<br />value: 0.000000e+00<br />type: original","w: 8.91e-03<br />value: 0.000000e+00<br />type: original","w: 1.00e-02<br />value: 0.000000e+00<br />type: original","w: 1.12e-02<br />value: 0.000000e+00<br />type: original","w: 1.26e-02<br />value: 0.000000e+00<br />type: original","w: 1.41e-02<br />value: 0.000000e+00<br />type: original","w: 1.58e-02<br />value: 0.000000e+00<br />type: original","w: 1.78e-02<br />value: 0.000000e+00<br />type: original","w: 2.00e-02<br />value: 0.000000e+00<br />type: original","w: 2.24e-02<br />value: 0.000000e+00<br />type: original","w: 2.51e-02<br />value: 0.000000e+00<br />type: original","w: 2.82e-02<br />value: 0.000000e+00<br />type: original","w: 3.16e-02<br />value: 0.000000e+00<br />type: original","w: 3.55e-02<br />value: 0.000000e+00<br />type: original","w: 3.98e-02<br />value: 0.000000e+00<br />type: original","w: 4.47e-02<br />value: 0.000000e+00<br />type: original","w: 5.01e-02<br />value: 0.000000e+00<br />type: original","w: 5.62e-02<br />value: 0.000000e+00<br />type: original","w: 6.31e-02<br />value: 0.000000e+00<br />type: original","w: 7.08e-02<br />value: 0.000000e+00<br />type: original","w: 7.94e-02<br />value: 0.000000e+00<br />type: original","w: 8.91e-02<br />value: 0.000000e+00<br />type: original","w: 1.00e-01<br />value: 0.000000e+00<br />type: original","w: 1.12e-01<br />value: 0.000000e+00<br />type: original","w: 1.26e-01<br />value: 0.000000e+00<br />type: original","w: 1.41e-01<br />value: 0.000000e+00<br />type: original","w: 1.58e-01<br />value: 0.000000e+00<br />type: original","w: 1.78e-01<br />value: 0.000000e+00<br />type: original","w: 2.00e-01<br />value: 0.000000e+00<br />type: original","w: 2.24e-01<br />value: 0.000000e+00<br />type: original","w: 2.51e-01<br />value: 0.000000e+00<br />type: original","w: 2.82e-01<br />value: 0.000000e+00<br />type: original","w: 3.16e-01<br />value: 0.000000e+00<br />type: original","w: 3.55e-01<br />value: 0.000000e+00<br />type: original","w: 3.98e-01<br />value: 0.000000e+00<br />type: original","w: 4.47e-01<br />value: 0.000000e+00<br />type: original","w: 5.01e-01<br />value: 0.000000e+00<br />type: original","w: 5.62e-01<br />value: 0.000000e+00<br />type: original","w: 6.31e-01<br />value: 0.000000e+00<br />type: original","w: 7.08e-01<br />value: 0.000000e+00<br />type: original","w: 7.94e-01<br />value: 0.000000e+00<br />type: original","w: 8.91e-01<br />value: 0.000000e+00<br />type: original","w: 1.00e+00<br />value: 0.000000e+00<br />type: original","w: 1.12e+00<br />value: 0.000000e+00<br />type: original","w: 1.26e+00<br />value: 0.000000e+00<br />type: original","w: 1.41e+00<br />value: 0.000000e+00<br />type: original","w: 1.58e+00<br />value: 0.000000e+00<br />type: original","w: 1.78e+00<br />value: 0.000000e+00<br />type: original","w: 2.00e+00<br />value: 0.000000e+00<br />type: original","w: 2.24e+00<br />value: 0.000000e+00<br />type: original","w: 2.51e+00<br />value: 0.000000e+00<br />type: original","w: 2.82e+00<br />value: 0.000000e+00<br />type: original","w: 3.16e+00<br />value: 0.000000e+00<br />type: original","w: 3.55e+00<br />value: 0.000000e+00<br />type: original","w: 3.98e+00<br />value: 0.000000e+00<br />type: original","w: 4.47e+00<br />value: 1.453784e-08<br />type: original","w: 5.01e+00<br />value: 4.731512e-08<br />type: original","w: 5.62e+00<br />value: 1.539926e-07<br />type: original","w: 6.31e+00<br />value: 5.011867e-07<br />type: original","w: 7.08e+00<br />value: 1.631168e-06<br />type: original","w: 7.94e+00<br />value: 5.308791e-06<br />type: original","w: 8.91e+00<br />value: 1.727771e-05<br />type: original","w: 1.00e+01<br />value: 5.622851e-05<br />type: original","w: 1.12e+01<br />value: 1.829628e-04<br />type: original","w: 1.26e+01<br />value: 5.950671e-04<br />type: original","w: 1.41e+01<br />value: 1.932541e-03<br />type: original","w: 1.58e+01<br />value: 6.247102e-03<br />type: original","w: 1.78e+01<br />value: 1.990577e-02<br />type: original","w: 2.00e+01<br />value: 6.075854e-02<br />type: original","w: 2.24e+01<br />value: 1.652605e-01<br />type: original","w: 2.51e+01<br />value: 3.539729e-01<br />type: original","w: 2.82e+01<br />value: 5.535654e-01<br />type: original","w: 3.16e+01<br />value: 6.817220e-01<br />type: original","w: 3.55e+01<br />value: 7.481335e-01<br />type: original","w: 3.98e+01<br />value: 7.864636e-01<br />type: original","w: 4.47e+01<br />value: 8.149460e-01<br />type: original","w: 5.01e+01<br />value: 8.405546e-01<br />type: original","w: 5.62e+01<br />value: 8.656906e-01<br />type: original","w: 6.31e+01<br />value: 8.911618e-01<br />type: original","w: 7.08e+01<br />value: 9.172469e-01<br />type: original","w: 7.94e+01<br />value: 9.440514e-01<br />type: original","w: 8.91e+01<br />value: 9.716249e-01<br />type: original","w: 1.00e+02<br />value: 9.999990e-01<br />type: original"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"original","legendgroup":"original","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283104,"r":7.3059360730593621,"b":40.182648401826491,"l":48.949771689497723},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.9989499999999998,104.99995],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Weight [g]","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.049999950000050003,1.04999895000105],"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[-6.9388939039072284e-18,0.24999999999999997,0.5,0.75,1],"categoryorder":"array","categoryarray":["0.00","0.25","0.50","0.75","1.00"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Proportion invested into reproduction","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"type","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"182965e2ddff":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"182965e2ddff","visdat":{"182965e2ddff":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This change in the maturity curve of course implies a change in the growth rates.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exercise 4
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Make a plot showing the growth rates of the original model and of the model with the changed maturity curve.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Show me the solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">growth_rate_frame</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"original"</span></span>
<span><span class="va">modified_growth_frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://sizespectrum.org/mizer/reference/getEGrowth.html">getEGrowth</a></span><span class="op">(</span><span class="va">params_changed_maturity</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">modified_growth_frame</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"changed"</span></span>
<span><span class="va">growth_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">growth_rate_frame</span>, <span class="va">modified_growth_frame</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">growth_combined</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">w</span>, y <span class="op">=</span> <span class="va">value</span>, colour <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Weight [g]"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Growth rate [g/year]"</span><span class="op">)</span></span>
<span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">ggplotly</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-989acba219e7317c6ed9" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-989acba219e7317c6ed9">{"x":{"data":[{"x":[0.001,0.0011199999999999999,0.0012600000000000001,0.00141,0.00158,0.0017799999999999999,0.002,0.0022399999999999998,0.0025100000000000001,0.00282,0.00316,0.0035500000000000002,0.00398,0.00447,0.0050099999999999997,0.00562,0.0063099999999999996,0.0070800000000000004,0.0079399999999999991,0.0089099999999999995,0.01,0.0112,0.0126,0.0141,0.015800000000000002,0.0178,0.02,0.0224,0.025100000000000001,0.028199999999999999,0.031600000000000003,0.035499999999999997,0.039800000000000002,0.044699999999999997,0.050099999999999999,0.0562,0.063100000000000003,0.070800000000000002,0.079399999999999998,0.089099999999999999,0.10000000000000001,0.112,0.126,0.14099999999999999,0.158,0.17799999999999999,0.20000000000000001,0.224,0.251,0.28199999999999997,0.316,0.35499999999999998,0.39800000000000002,0.44700000000000001,0.501,0.56200000000000006,0.63100000000000001,0.70799999999999996,0.79400000000000004,0.89100000000000001,1,1.1200000000000001,1.26,1.4099999999999999,1.5800000000000001,1.78,2,2.2400000000000002,2.5099999999999998,2.8199999999999998,3.1600000000000001,3.5499999999999998,3.98,4.4699999999999998,5.0099999999999998,5.6200000000000001,6.3099999999999996,7.0800000000000001,7.9400000000000004,8.9100000000000001,10,11.199999999999999,12.6,14.1,15.800000000000001,17.800000000000001,20,22.399999999999999,25.100000000000001,28.199999999999999,31.600000000000001,35.5,39.799999999999997,44.700000000000003,50.100000000000001,56.200000000000003,63.100000000000001,70.799999999999997,79.400000000000006,89.099999999999994,100],"y":[0.023618335657994673,0.025748343270292465,0.028070444537881815,0.030601963329555545,0.03336178585841984,0.03637050158112274,0.039650556804008752,0.043226422142165946,0.047124775080682468,0.051374699000097099,0.056007900150859602,0.061058944195521762,0.066565514083366792,0.072568691181330247,0.079113261758571612,0.086248051111200125,0.0940262878198702,0.10250600085776315,0.11175045251154997,0.12182861034511253,0.13281566172707199,0.1447935747607228,0.1578517098011466,0.17208748612168728,0.18760710870340455,0.20452636056966247,0.22297146657701519,0.24308003510663065,0.26500208468168124,0.28890116316969927,0.31495556791963125,0.34335967593633276,0.37432539401617315,0.40808373966238431,0.44488656457446135,0.48500843356957229,0.52874867295354999,0.57643360362317586,0.62841897555966197,0.68509262187569164,0.74687735221634732,0.81423410709992716,0.88766539673139155,0.96771904994345481,1.0549923012340234,1.150136246391031,1.2538606999455428,1.3669394906917924,1.4902162347810164,1.6246106294588183,1.7711253144000458,1.9308533449628202,2.1049863692754269,2.2948234886760921,2.5017809665488593,2.72740278944798,2.9733721843944476,3.2415241738508835,3.5338592612134212,3.8525583474800014,4.1999989878718775,4.5787731053216412,4.9917062853710714,5.4418787831790061,5.932648376288844,6.4676751934675982,7.0509486348788695,7.6868164625765578,8.3800160661683165,9.135707767461513,9.9595097693714472,10.857533890271121,11.836420402223062,12.903368844562227,14.066159153418713,15.333153040368245,16.713257910729329,18.215822426160404,19.85041022466514,21.626360006235505,23.55197629998754,25.633091463873367,27.87057844728492,30.256164036233365,32.765618286194041,35.348218421520883,37.91173275517,40.304013744342058,42.297183727822684,43.589173601105578,43.84562635849128,42.797436569938291,40.367516827403804,36.744145170396315,32.323513841144369,27.544917411957066,22.732230944219296,18.027496822593122,13.411653593890307,8.7606288066555038,3.8962640102945727],"text":["w: 1.00e-03<br />value: 2.361834e-02<br />type: changed","w: 1.12e-03<br />value: 2.574834e-02<br />type: changed","w: 1.26e-03<br />value: 2.807044e-02<br />type: changed","w: 1.41e-03<br />value: 3.060196e-02<br />type: changed","w: 1.58e-03<br />value: 3.336179e-02<br />type: changed","w: 1.78e-03<br />value: 3.637050e-02<br />type: changed","w: 2.00e-03<br />value: 3.965056e-02<br />type: changed","w: 2.24e-03<br />value: 4.322642e-02<br />type: changed","w: 2.51e-03<br />value: 4.712478e-02<br />type: changed","w: 2.82e-03<br />value: 5.137470e-02<br />type: changed","w: 3.16e-03<br />value: 5.600790e-02<br />type: changed","w: 3.55e-03<br />value: 6.105894e-02<br />type: changed","w: 3.98e-03<br />value: 6.656551e-02<br />type: changed","w: 4.47e-03<br />value: 7.256869e-02<br />type: changed","w: 5.01e-03<br />value: 7.911326e-02<br />type: changed","w: 5.62e-03<br />value: 8.624805e-02<br />type: changed","w: 6.31e-03<br />value: 9.402629e-02<br />type: changed","w: 7.08e-03<br />value: 1.025060e-01<br />type: changed","w: 7.94e-03<br />value: 1.117505e-01<br />type: changed","w: 8.91e-03<br />value: 1.218286e-01<br />type: changed","w: 1.00e-02<br />value: 1.328157e-01<br />type: changed","w: 1.12e-02<br />value: 1.447936e-01<br />type: changed","w: 1.26e-02<br />value: 1.578517e-01<br />type: changed","w: 1.41e-02<br />value: 1.720875e-01<br />type: changed","w: 1.58e-02<br />value: 1.876071e-01<br />type: changed","w: 1.78e-02<br />value: 2.045264e-01<br />type: changed","w: 2.00e-02<br />value: 2.229715e-01<br />type: changed","w: 2.24e-02<br />value: 2.430800e-01<br />type: changed","w: 2.51e-02<br />value: 2.650021e-01<br />type: changed","w: 2.82e-02<br />value: 2.889012e-01<br />type: changed","w: 3.16e-02<br />value: 3.149556e-01<br />type: changed","w: 3.55e-02<br />value: 3.433597e-01<br />type: changed","w: 3.98e-02<br />value: 3.743254e-01<br />type: changed","w: 4.47e-02<br />value: 4.080837e-01<br />type: changed","w: 5.01e-02<br />value: 4.448866e-01<br />type: changed","w: 5.62e-02<br />value: 4.850084e-01<br />type: changed","w: 6.31e-02<br />value: 5.287487e-01<br />type: changed","w: 7.08e-02<br />value: 5.764336e-01<br />type: changed","w: 7.94e-02<br />value: 6.284190e-01<br />type: changed","w: 8.91e-02<br />value: 6.850926e-01<br />type: changed","w: 1.00e-01<br />value: 7.468774e-01<br />type: changed","w: 1.12e-01<br />value: 8.142341e-01<br />type: changed","w: 1.26e-01<br />value: 8.876654e-01<br />type: changed","w: 1.41e-01<br />value: 9.677190e-01<br />type: changed","w: 1.58e-01<br />value: 1.054992e+00<br />type: changed","w: 1.78e-01<br />value: 1.150136e+00<br />type: changed","w: 2.00e-01<br />value: 1.253861e+00<br />type: changed","w: 2.24e-01<br />value: 1.366939e+00<br />type: changed","w: 2.51e-01<br />value: 1.490216e+00<br />type: changed","w: 2.82e-01<br />value: 1.624611e+00<br />type: changed","w: 3.16e-01<br />value: 1.771125e+00<br />type: changed","w: 3.55e-01<br />value: 1.930853e+00<br />type: changed","w: 3.98e-01<br />value: 2.104986e+00<br />type: changed","w: 4.47e-01<br />value: 2.294823e+00<br />type: changed","w: 5.01e-01<br />value: 2.501781e+00<br />type: changed","w: 5.62e-01<br />value: 2.727403e+00<br />type: changed","w: 6.31e-01<br />value: 2.973372e+00<br />type: changed","w: 7.08e-01<br />value: 3.241524e+00<br />type: changed","w: 7.94e-01<br />value: 3.533859e+00<br />type: changed","w: 8.91e-01<br />value: 3.852558e+00<br />type: changed","w: 1.00e+00<br />value: 4.199999e+00<br />type: changed","w: 1.12e+00<br />value: 4.578773e+00<br />type: changed","w: 1.26e+00<br />value: 4.991706e+00<br />type: changed","w: 1.41e+00<br />value: 5.441879e+00<br />type: changed","w: 1.58e+00<br />value: 5.932648e+00<br />type: changed","w: 1.78e+00<br />value: 6.467675e+00<br />type: changed","w: 2.00e+00<br />value: 7.050949e+00<br />type: changed","w: 2.24e+00<br />value: 7.686816e+00<br />type: changed","w: 2.51e+00<br />value: 8.380016e+00<br />type: changed","w: 2.82e+00<br />value: 9.135708e+00<br />type: changed","w: 3.16e+00<br />value: 9.959510e+00<br />type: changed","w: 3.55e+00<br />value: 1.085753e+01<br />type: changed","w: 3.98e+00<br />value: 1.183642e+01<br />type: changed","w: 4.47e+00<br />value: 1.290337e+01<br />type: changed","w: 5.01e+00<br />value: 1.406616e+01<br />type: changed","w: 5.62e+00<br />value: 1.533315e+01<br />type: changed","w: 6.31e+00<br />value: 1.671326e+01<br />type: changed","w: 7.08e+00<br />value: 1.821582e+01<br />type: changed","w: 7.94e+00<br />value: 1.985041e+01<br />type: changed","w: 8.91e+00<br />value: 2.162636e+01<br />type: changed","w: 1.00e+01<br />value: 2.355198e+01<br />type: changed","w: 1.12e+01<br />value: 2.563309e+01<br />type: changed","w: 1.26e+01<br />value: 2.787058e+01<br />type: changed","w: 1.41e+01<br />value: 3.025616e+01<br />type: changed","w: 1.58e+01<br />value: 3.276562e+01<br />type: changed","w: 1.78e+01<br />value: 3.534822e+01<br />type: changed","w: 2.00e+01<br />value: 3.791173e+01<br />type: changed","w: 2.24e+01<br />value: 4.030401e+01<br />type: changed","w: 2.51e+01<br />value: 4.229718e+01<br />type: changed","w: 2.82e+01<br />value: 4.358917e+01<br />type: changed","w: 3.16e+01<br />value: 4.384563e+01<br />type: changed","w: 3.55e+01<br />value: 4.279744e+01<br />type: changed","w: 3.98e+01<br />value: 4.036752e+01<br />type: changed","w: 4.47e+01<br />value: 3.674415e+01<br />type: changed","w: 5.01e+01<br />value: 3.232351e+01<br />type: changed","w: 5.62e+01<br />value: 2.754492e+01<br />type: changed","w: 6.31e+01<br />value: 2.273223e+01<br />type: changed","w: 7.08e+01<br />value: 1.802750e+01<br />type: changed","w: 7.94e+01<br />value: 1.341165e+01<br />type: changed","w: 8.91e+01<br />value: 8.760629e+00<br />type: changed","w: 1.00e+02<br />value: 3.896264e+00<br />type: changed"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"changed","legendgroup":"changed","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.001,0.0011199999999999999,0.0012600000000000001,0.00141,0.00158,0.0017799999999999999,0.002,0.0022399999999999998,0.0025100000000000001,0.00282,0.00316,0.0035500000000000002,0.00398,0.00447,0.0050099999999999997,0.00562,0.0063099999999999996,0.0070800000000000004,0.0079399999999999991,0.0089099999999999995,0.01,0.0112,0.0126,0.0141,0.015800000000000002,0.0178,0.02,0.0224,0.025100000000000001,0.028199999999999999,0.031600000000000003,0.035499999999999997,0.039800000000000002,0.044699999999999997,0.050099999999999999,0.0562,0.063100000000000003,0.070800000000000002,0.079399999999999998,0.089099999999999999,0.10000000000000001,0.112,0.126,0.14099999999999999,0.158,0.17799999999999999,0.20000000000000001,0.224,0.251,0.28199999999999997,0.316,0.35499999999999998,0.39800000000000002,0.44700000000000001,0.501,0.56200000000000006,0.63100000000000001,0.70799999999999996,0.79400000000000004,0.89100000000000001,1,1.1200000000000001,1.26,1.4099999999999999,1.5800000000000001,1.78,2,2.2400000000000002,2.5099999999999998,2.8199999999999998,3.1600000000000001,3.5499999999999998,3.98,4.4699999999999998,5.0099999999999998,5.6200000000000001,6.3099999999999996,7.0800000000000001,7.9400000000000004,8.9100000000000001,10,11.199999999999999,12.6,14.1,15.800000000000001,17.800000000000001,20,22.399999999999999,25.100000000000001,28.199999999999999,31.600000000000001,35.5,39.799999999999997,44.700000000000003,50.100000000000001,56.200000000000003,63.100000000000001,70.799999999999997,79.400000000000006,89.099999999999994,100],"y":[0.023618335657994673,0.025748343270292465,0.028070444537881815,0.030601963329555545,0.03336178585841984,0.03637050158112274,0.039650556804008752,0.043226422142165946,0.047124775080682468,0.051374699000097099,0.056007900150859602,0.061058944195521762,0.066565514083366792,0.072568691181330247,0.079113261758571612,0.086248051111200125,0.0940262878198702,0.10250600085776315,0.11175045251154997,0.12182861034511253,0.13281566172707199,0.1447935747607228,0.1578517098011466,0.17208748612168728,0.18760710870340455,0.20452636056966247,0.22297146657701519,0.24308003510663065,0.26500208468168124,0.28890116316969927,0.31495556791963125,0.34335967593633276,0.37432539401617315,0.40808373966238431,0.44488656457446135,0.48500843356957229,0.52874867295354999,0.57643360362317586,0.62841897555966197,0.68509262187569164,0.74687735221634732,0.81423410709992716,0.88766539673139155,0.96771904994345481,1.0549923012340234,1.150136246391031,1.2538606999455428,1.3669394906917924,1.4902162347810164,1.6246106294588183,1.7711253144000458,1.9308533518296622,2.1049863812345446,2.2948235095037877,2.5017810028218443,2.7274028526200875,2.9733722944133811,3.24152436545705,3.5338595949098184,3.8525589286370714,4.1999999999999993,4.5787748680175362,4.9917093552354768,5.4418841295714833,5.9326576874155714,6.4676914094498663,7.0509768761147544,7.6868656465064307,8.3801017228693002,9.1358569428820022,9.9597695637789538,10.857986326161198,11.837208311310707,12.904740746516175,14.06854777897369,15.337310982870351,16.720492783153549,18.228401339450325,19.872247378207053,21.664156619479662,23.617007634179775,25.743632282529518,28.053740740515945,30.542823768394491,33.15337136522831,35.646518581564813,37.241446943266205,36.082803822639661,30.443882151472508,22.935442233089741,17.826081969041418,15.378705110535364,14.214160325589496,13.429130020266371,12.614246690273148,11.583926758810932,10.233649854973791,8.4826863161639778,6.2522773698990477,3.4569015562156835,0.00013281552890020976],"text":["w: 1.00e-03<br />value: 2.361834e-02<br />type: original","w: 1.12e-03<br />value: 2.574834e-02<br />type: original","w: 1.26e-03<br />value: 2.807044e-02<br />type: original","w: 1.41e-03<br />value: 3.060196e-02<br />type: original","w: 1.58e-03<br />value: 3.336179e-02<br />type: original","w: 1.78e-03<br />value: 3.637050e-02<br />type: original","w: 2.00e-03<br />value: 3.965056e-02<br />type: original","w: 2.24e-03<br />value: 4.322642e-02<br />type: original","w: 2.51e-03<br />value: 4.712478e-02<br />type: original","w: 2.82e-03<br />value: 5.137470e-02<br />type: original","w: 3.16e-03<br />value: 5.600790e-02<br />type: original","w: 3.55e-03<br />value: 6.105894e-02<br />type: original","w: 3.98e-03<br />value: 6.656551e-02<br />type: original","w: 4.47e-03<br />value: 7.256869e-02<br />type: original","w: 5.01e-03<br />value: 7.911326e-02<br />type: original","w: 5.62e-03<br />value: 8.624805e-02<br />type: original","w: 6.31e-03<br />value: 9.402629e-02<br />type: original","w: 7.08e-03<br />value: 1.025060e-01<br />type: original","w: 7.94e-03<br />value: 1.117505e-01<br />type: original","w: 8.91e-03<br />value: 1.218286e-01<br />type: original","w: 1.00e-02<br />value: 1.328157e-01<br />type: original","w: 1.12e-02<br />value: 1.447936e-01<br />type: original","w: 1.26e-02<br />value: 1.578517e-01<br />type: original","w: 1.41e-02<br />value: 1.720875e-01<br />type: original","w: 1.58e-02<br />value: 1.876071e-01<br />type: original","w: 1.78e-02<br />value: 2.045264e-01<br />type: original","w: 2.00e-02<br />value: 2.229715e-01<br />type: original","w: 2.24e-02<br />value: 2.430800e-01<br />type: original","w: 2.51e-02<br />value: 2.650021e-01<br />type: original","w: 2.82e-02<br />value: 2.889012e-01<br />type: original","w: 3.16e-02<br />value: 3.149556e-01<br />type: original","w: 3.55e-02<br />value: 3.433597e-01<br />type: original","w: 3.98e-02<br />value: 3.743254e-01<br />type: original","w: 4.47e-02<br />value: 4.080837e-01<br />type: original","w: 5.01e-02<br />value: 4.448866e-01<br />type: original","w: 5.62e-02<br />value: 4.850084e-01<br />type: original","w: 6.31e-02<br />value: 5.287487e-01<br />type: original","w: 7.08e-02<br />value: 5.764336e-01<br />type: original","w: 7.94e-02<br />value: 6.284190e-01<br />type: original","w: 8.91e-02<br />value: 6.850926e-01<br />type: original","w: 1.00e-01<br />value: 7.468774e-01<br />type: original","w: 1.12e-01<br />value: 8.142341e-01<br />type: original","w: 1.26e-01<br />value: 8.876654e-01<br />type: original","w: 1.41e-01<br />value: 9.677190e-01<br />type: original","w: 1.58e-01<br />value: 1.054992e+00<br />type: original","w: 1.78e-01<br />value: 1.150136e+00<br />type: original","w: 2.00e-01<br />value: 1.253861e+00<br />type: original","w: 2.24e-01<br />value: 1.366939e+00<br />type: original","w: 2.51e-01<br />value: 1.490216e+00<br />type: original","w: 2.82e-01<br />value: 1.624611e+00<br />type: original","w: 3.16e-01<br />value: 1.771125e+00<br />type: original","w: 3.55e-01<br />value: 1.930853e+00<br />type: original","w: 3.98e-01<br />value: 2.104986e+00<br />type: original","w: 4.47e-01<br />value: 2.294824e+00<br />type: original","w: 5.01e-01<br />value: 2.501781e+00<br />type: original","w: 5.62e-01<br />value: 2.727403e+00<br />type: original","w: 6.31e-01<br />value: 2.973372e+00<br />type: original","w: 7.08e-01<br />value: 3.241524e+00<br />type: original","w: 7.94e-01<br />value: 3.533860e+00<br />type: original","w: 8.91e-01<br />value: 3.852559e+00<br />type: original","w: 1.00e+00<br />value: 4.200000e+00<br />type: original","w: 1.12e+00<br />value: 4.578775e+00<br />type: original","w: 1.26e+00<br />value: 4.991709e+00<br />type: original","w: 1.41e+00<br />value: 5.441884e+00<br />type: original","w: 1.58e+00<br />value: 5.932658e+00<br />type: original","w: 1.78e+00<br />value: 6.467691e+00<br />type: original","w: 2.00e+00<br />value: 7.050977e+00<br />type: original","w: 2.24e+00<br />value: 7.686866e+00<br />type: original","w: 2.51e+00<br />value: 8.380102e+00<br />type: original","w: 2.82e+00<br />value: 9.135857e+00<br />type: original","w: 3.16e+00<br />value: 9.959770e+00<br />type: original","w: 3.55e+00<br />value: 1.085799e+01<br />type: original","w: 3.98e+00<br />value: 1.183721e+01<br />type: original","w: 4.47e+00<br />value: 1.290474e+01<br />type: original","w: 5.01e+00<br />value: 1.406855e+01<br />type: original","w: 5.62e+00<br />value: 1.533731e+01<br />type: original","w: 6.31e+00<br />value: 1.672049e+01<br />type: original","w: 7.08e+00<br />value: 1.822840e+01<br />type: original","w: 7.94e+00<br />value: 1.987225e+01<br />type: original","w: 8.91e+00<br />value: 2.166416e+01<br />type: original","w: 1.00e+01<br />value: 2.361701e+01<br />type: original","w: 1.12e+01<br />value: 2.574363e+01<br />type: original","w: 1.26e+01<br />value: 2.805374e+01<br />type: original","w: 1.41e+01<br />value: 3.054282e+01<br />type: original","w: 1.58e+01<br />value: 3.315337e+01<br />type: original","w: 1.78e+01<br />value: 3.564652e+01<br />type: original","w: 2.00e+01<br />value: 3.724145e+01<br />type: original","w: 2.24e+01<br />value: 3.608280e+01<br />type: original","w: 2.51e+01<br />value: 3.044388e+01<br />type: original","w: 2.82e+01<br />value: 2.293544e+01<br />type: original","w: 3.16e+01<br />value: 1.782608e+01<br />type: original","w: 3.55e+01<br />value: 1.537871e+01<br />type: original","w: 3.98e+01<br />value: 1.421416e+01<br />type: original","w: 4.47e+01<br />value: 1.342913e+01<br />type: original","w: 5.01e+01<br />value: 1.261425e+01<br />type: original","w: 5.62e+01<br />value: 1.158393e+01<br />type: original","w: 6.31e+01<br />value: 1.023365e+01<br />type: original","w: 7.08e+01<br />value: 8.482686e+00<br />type: original","w: 7.94e+01<br />value: 6.252277e+00<br />type: original","w: 8.91e+01<br />value: 3.456902e+00<br />type: original","w: 1.00e+02<br />value: 1.328155e-04<br />type: original"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"original","legendgroup":"original","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283104,"r":7.3059360730593621,"b":40.182648401826491,"l":37.260273972602747},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.9989499999999998,104.99995],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Weight [g]","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.192141861619219,46.037901035639401],"tickmode":"array","ticktext":["0","10","20","30","40"],"tickvals":[0,10.000000000000004,20,30,40],"categoryorder":"array","categoryarray":["0","10","20","30","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Growth rate [g/year]","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"type","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"18296229d84df":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"18296229d84df","visdat":{"18296229d84df":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="effect-of-changed-maturity" class="level3"><h3 class="anchored" data-anchor-id="effect-of-changed-maturity">Effect of changed maturity</h3>
<p>Next let us look at how the change in the maturity parameters and the resulting change in the growth rate affects the steady state spectrum. First we need to calculate the new steady state using the function <code><a href="https://sizespectrum.org/mizer/reference/steadySingleSpecies.html">steadySingleSpecies()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">params_changed_maturity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://sizespectrum.org/mizer/reference/steadySingleSpecies.html">steadySingleSpecies</a></span><span class="op">(</span><span class="va">params_changed_maturity</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we can use the function <code><a href="https://sizespectrum.org/mizerExperimental/reference/plotSpectra2.html">plotSpectra2()</a></code> to plot the old size spectrum and the new size spectrum on the same graph.</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://sizespectrum.org/mizerExperimental/reference/plotSpectra2.html">plotSpectra2</a></span><span class="op">(</span><span class="va">params</span>, name1 <span class="op">=</span> <span class="st">"Early maturity"</span>,</span>
<span>             <span class="va">params_changed_maturity</span>, name2 <span class="op">=</span> <span class="st">"Late maturity"</span>,</span>
<span>             power <span class="op">=</span> <span class="fl">2</span>, resource <span class="op">=</span> <span class="cn">FALSE</span>, wlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="single-species-spectra_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As expected, the bump happens later due to the larger maturity size and it is less steep, because the maturity curve is less steep. This means that fish do not suddenly start investing most of their energy into reproduction, but still keep growing while they are maturity. Since they are still growing they will be moving from one size class to another and fewer individuals will accumulate in one size class.</p>
<p>This was our first investigation of how the shape of a species size spectrum changes as model parameters are changed. We will do much more in this direction in the next tutorial in which we discuss how growth and mortality are determined through predation.</p>
</section></section><section id="summary-and-recap" class="level2"><h2 class="anchored" data-anchor-id="summary-and-recap">Summary and recap</h2>
<p>1) The steady state is the state where the system has reached an equilibrium in which the rate at which individuals grow into each size class is equal to the rate at which individuals either grow out of the size class or die in the size class.</p>
<p>2) Mizer stores the size spectrum in the form of the number density in size classes. To get the numbers in a size class we need to multiply the number density by the width of the size class (dw). To get total biomass in each size class we further multiple this value by the weight of this size class (w).</p>
<p>3) Allometric scaling of physiological rates with size plays a big role in a mizer model and shapes the size spectrum.</p>
<p>4) We studied a single species living in a fixed background community with a power-law spectrum. In this simple case we can determine the steady state spectrum and find that the juvenile spectrum is given by a power law whose exponent is determined by the ratio of mortality to growth and is different from the community spectrum power law.</p>
<p>5) As fish mature they start investing some of their energy into reproduction and hence their growth slows. This leads to a bump in the size spectrum. We saw how changes in the parameters describing the maturity ogive change the shape of that bump.</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/mizer\.course\.sizespectrum\.org");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="gustavdelius/mizerCourse" data-repo-id="R_kgDOK0vNNg" data-category="Comments" data-category-id="DIC_kwDOK0vNNs4CbfmH" data-mapping="title" data-reactions-enabled="0" data-emit-metadata="0" data-input-position="bottom" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../understand/observed-size-spectra.html" class="pagination-link" aria-label="Observed size spectra">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Observed size spectra</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../understand/predation-growth-and-mortality.html" class="pagination-link" aria-label="Predation, growth and mortality">
        <span class="nav-page-text">Predation, growth and mortality</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gustavdelius/mizerCourse/edit/master/understand/single-species-spectra.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/gustavdelius/mizerCourse/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>